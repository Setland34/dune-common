// @GENERATED_SOURCE@

#if HAVE_CONFIG_H
#include "config.h"
#endif

#if !HAVE_VC
#error Inconsistent buildsystem.  This program should not be built in the \
  absence of Vc.
#endif

#include <cstddef>
#include <cstdlib>
#include <type_traits>

#include <dune/common/simd/test.hh>
#include <dune/common/simd/test/vcarraytest.hh>
#include <dune/common/simd/vc.hh>
#include <dune/common/typelist.hh>

// ignore rebinds to LoopSIMD as well as Vc::Vector and Vc::Mask
template<class T> struct Prune : Dune::Simd::IsLoop<T>  {};
template<class T, class A>
struct Prune<Vc::Vector<T, A> > : std::true_type {};
template<class T, class A>
struct Prune<Vc::Mask<T, A> >   : std::true_type {};

using Rebinds = Dune::TypeList<
#cmake @template@
  @SCALAR@,
#cmake @endtemplate@
  bool,
  std::size_t>;

int main()
{
  using Vc::Vector;
  using Vc::SimdArray;

  Dune::Simd::UnitTest test;

#@template@
  test.check<SimdArray<@SCALAR@, ::lanes>, Rebinds, Prune>();
#@endtemplate@

  return test.good() ? EXIT_SUCCESS : EXIT_FAILURE;
}
